[Главная](../main.md)

[TOC]

# Уменьшение размера сборки приложения

## Android

Файлы занимающие значительный обьем в сборке:
- `libflutter.so` - run-time библиотека фреймворка. Комманда flutter обещает оптимизировать размер этого файла в будущих версиях, либо вынести его в отдельно устанавливаемый run-time пакет; 
- `libapp.so` - скомпилированное приложение;
- `classes.dex` - собранные в кучу нативные части всех используемых библиотек. Большинство библиотек уже проходило через обфускатор;
- каталог `res` - тут собраные системные ресурсы, такие как иконки Material и Cupertino, так же коллекция assets из каталога проекта;
- все остальное в сумме менее 1% по объему;

Пара файлов `libflutter.so` и `libapp.so` помещаются в сборку для каждой поддерживаемой платформы, то есть если собрать однусборку для x86, x86_64, armeabiv7a, arm64_v8a, то сборка занимает значительные объем.
Как вариант, можно запускать сборку с параметром `--split-per-abi`:
```
flutter build apk --split-per-abi
```
В таком случае мы получаем несколько сборок для разных платформ, каждая из которых будет менее 10 мб для release.


## iOS

Сборка приложения для iOS имеет размер больше, чем сборка этого же приложения для Android.
Главным образом потому, что Apple шифрует двоичные файлы в пределах IPA, делая сжатие менее эффективным.

Общая рекомендация - предпочесть загрузку объемных данных из assets вместо объявления статических констант.

Apple позаботилось о частичной загрузке обновлений приложения из App Store.
Цитата из базы знаний: 
```
Для устройств под управлением iOS 7.1 и более поздних версий пакет обновления может содержать только различия 
между старой и новой версиями измененного файла, а не полного файла. Это может значительно уменьшить размер пакета 
обновления в случае, если изменяется только небольшая часть большого файла, но увеличит время установки обновления 
на устройстве. 
```
