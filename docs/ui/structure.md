# Структура UI 

UI слой
=======

### WidgetModel

Данная сущность представляет собой ViewModel из MVVM. 
Также можно провести аналогию с BLoC, но только в плане механизма взаимодейтсвия.

Работа с View(Widget) производится через поток. Данная модель ничего не знает про
конкретный виджет, который ее использует.

Основные компоненты WidgetModel - `Event'ы`:
 - Action - потоковое представление действия, ex: клик на кнопку, изменение фокуса.
 - StreamedState - потоковое представление того или иного свойства. ex: счетчик товаров, состояние enable
 - EntityStreamedState - наследник StreamedState, которое имеет состояния загрузки/ошибки/контента
 - дополнительная логика, которая связывает Действия и Стейт.

WM является промежуточным звеном между Model(в любом ее варианте) и Widget.

Зависимости из Model поставляются на WM также через конструктор. 
В наших проектах для обепечения DI используется [Injector][].

### Widget

При использовании WM должен использоваться StatefulWidget.

State такого виджета должен быть наследником `WidgetState<>`.
Этот класс, расширяет State и добавляет автоматическую отписку потоков внутри модели,
а также автоматически связывает и конфигурирует WM.

Для конфигурации зависимостей для экрана(виджета) необходимо переопределить метод 
`getComponent()` у WidgetState, в котором указать необходимый экрану `BaseWidgetModelComponent`.
Также WidgetState необходимо типизировать:
1. Widget - виджет, котрому принадлежит стейт
1. WidgetModel - тип WM, который используется в виджете.
1. WidgetComponent - тип  компонента ждля внедрения зависимостей на виджет.

**Важно**: При использовании `Injector` правильно выбирайте context.

*Примечания*:
- Widget - это любой виджет из Flutter.
- Для подписки на изменение модели используется StreamBuilder.

