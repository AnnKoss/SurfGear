# FlexibleBottomSheet

[Главная](../main.md)

Данный BottomSheet имеет следующее поведение:

1. Имеет ограничение размера сверху и снизу, может быть выставлено как в абсолютных величинах,
так и в части от родительского контейнера.
2. При наличии внутри списка сначала расширяется, а уже потом при достижении верхней границы
размера скроллит сам список.
3. Кастомизация внутренностей достигается передачей функции билдинга.
4. Имеется возможность вызвать императивно, командой showFlexibleBottomSheet(),
или используя контроллер.

Во время разработки пробовались различные варианты подходов к реализации.

- Управлять через GestureDetector контроллером прокрутки, как результат получили множество проблем
на стыке переключения поведения с расширения на скролл и обратно.
В том числе продолжает работать наш GestureDetector вместо Scrollable.
- Использовать просто Scrollable и выключать ему setCanDrag или setIgnorePointer. Вариант тоже не
заработал - сыпятся ошибки на смену replaceSemanticsActions во время посроения лейаута.
- Использовать ViewPort внутри виджета и строить его самостоятельно - работает вроде правильно,
но мы теряем любую физику и не понятно как быть с обработкой жестов внутри переданных для
отображения элементов, допустим ListView
- IgnorePointer в купе с GestureDetector, проблемы аналогичные первому пункту
- Попытка генерировать эвенты жестов тоже не получилось. Рендеры объектов связываются с биндингами,
см. BindingBase, которые получают события как раз от движка, так что взаимодействовать на
этом уровне тоже не выходит.

В результате получилось реализовать основываясь на DraggableScrollableSheet.
https://api.flutter.dev/flutter/widgets/DraggableScrollableSheet-class.html

Так же во время поиска решения проблемы был подробно изучен принцип работы ScrollableView
и составлена схема.
https://drive.google.com/file/d/1i2s49pMOJNh-ZAhkNwMYgRoONX1jjx_y/view?usp=sharing